create table if not exists address
(
    id      integer generated by default as identity
        primary key,
    city    varchar(255) not null,
    country varchar(255) not null,
    line    varchar(255) not null
);

alter table address
    owner to postgres;

create table if not exists roles
(
    id        integer generated by default as identity
        primary key,
    role_type varchar(255) not null
        constraint uk6kpjgt1lwdofsckw70uo9eo0
            unique
        constraint roles_role_type_check
            check ((role_type)::text = ANY
                   ((ARRAY ['CLIENT'::character varying, 'HOTEL_MANAGER'::character varying])::text[]))
);

alter table roles
    owner to postgres;

create table if not exists users
(
    id           integer generated by default as identity
        primary key,
    created_date timestamp(6),
    last_name    varchar(255) not null,
    name         varchar(255) not null,
    password     varchar(255) not null,
    username     varchar(255) not null
        constraint ukr43af9ap4edm43mmtq01oddj6
            unique,
    role_id      integer      not null
        constraint fkp56c1712k691lhsyewcssf40f
            references roles
);

alter table users
    owner to postgres;

create table if not exists clients
(
    id      integer generated by default as identity
        primary key,
    user_id integer not null
        constraint uksmrp6gi0tckq1w5rnd7boyowu
            unique
        constraint fktiuqdledq2lybrds2k3rfqrv4
            references users
);

alter table clients
    owner to postgres;

create table if not exists hotel_managers
(
    id      integer generated by default as identity
        primary key,
    user_id integer not null
        constraint uk32uybpdrm1442ey63ia8ib7lv
            unique
        constraint fk1uq5ql707mbeoc9d9gqpiy8wp
            references users
);

alter table hotel_managers
    owner to postgres;

create table if not exists hotels
(
    id               integer generated by default as identity
        primary key,
    category_type    varchar(255)
        constraint hotels_category_type_check
            check ((category_type)::text = 'HOTEL'::text),
    description      varchar(255) not null,
    is_active        boolean      not null,
    name             varchar(255) not null
        constraint ukm7xlqsndengqp2kpd5nux2s3i
            unique,
    address_id       integer      not null
        constraint ukwho36q9mjwkmu27v3xycfjo9
            unique
        constraint fkqi7twk71v7d7fgtm1w09c9eri
            references address,
    hotel_manager_id integer      not null
        constraint fkgy0qftdufd8p6dawavhfaea68
            references hotel_managers
);

alter table hotels
    owner to postgres;

create table if not exists rooms
(
    id            integer generated by default as identity
        primary key,
    current_price numeric(38, 2) not null,
    description   varchar(255)   not null,
    name          varchar(255)   not null,
    room_type     varchar(255)
        constraint rooms_room_type_check
            check ((room_type)::text = ANY
                   ((ARRAY ['SINGLE'::character varying, 'DOUBLE'::character varying])::text[])),
    hotel_id      integer        not null
        constraint fkp5lufxy0ghq53ugm93hdc941k
            references hotels
);

alter table rooms
    owner to postgres;

create table if not exists booking
(
    id               integer generated by default as identity
        primary key,
    booking_status   varchar(255)   not null,
    created          timestamp(6),
    discount_percent numeric(38, 2) not null,
    end_date         date,
    start_date       date,
    total_price      numeric(38, 2) not null,
    updated          timestamp(6),
    client_id        integer        not null
        constraint fkp212rkyrbbp4r4wphugqoxwhs
            references clients,
    room_id          integer        not null
        constraint fkb6jhn9s6v53eb2cd9l7uhcd0m
            references rooms
);

alter table booking
    owner to postgres;

create table if not exists unavailability
(
    id         integer generated by default as identity
        primary key,
    end_date   date    not null,
    start_date date    not null,
    room_id    integer not null
        constraint fk7vf8fkiuess0y7dcvowh473rm
            references rooms
);

alter table unavailability
    owner to postgres;